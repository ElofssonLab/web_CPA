\documentclass[a4,center,fleqn]{NAR}

% Enter dates of publication
\copyrightyear{2018}
\pubdate{31 July 2019}
\pubyear{2019}
\jvolume{00}
\jissue{00}

%\articlesubtype{This is the article type (optional)}

\begin{document}

\title{PconsFam: A regularly updated database of structure predictions of all Pfam families available at http://pconsfold.bioinfo.se/}

\author{%
John Lamb\,$^{1,*}$,
Aleksandra I. Jarmolinska\,$^{2,*}$
Mirco Michel\,$^{1,*}$,
David Menéndez-Hurtado\,$^{1,*}$,
Joanna I. Sulkowska,$^{2,\dagger}$
Arne Elofsson\,$^{1,\dagger}$%
\footnote{To whom correspondence should be addressed.
Tel: +46 706951045; Email: arne@bioinfo.se}}

\address{%
$^{1}$Science for Life Laboratory and Department of Biochemistry and
biophysics, Stockholm Unviersity, Tomtebodav 23, 171 21 Solna, Sweden
and
<<<<<<< HEAD
$^{2}$ Interdisciplinary Laboratory of Biological Systems Modelling
ul. S. Banacha 2c, 02-097 Warsaw, Poland 
=======
$^{2}$ Centre of New Technologies, University of Warsaw, Banacha 2c, 02-097 Warsaw,
Poland
>>>>>>> edddcae0bb6a2db70da710e7fb992811feafc57e
$^{*}$ contributed equally
$^{\dagger}$=contributing authors
% Affiliation must include:
% Department name, institution name, full road and district address,
% state, Zip or postal code, country
}

\history{%
Received January 1, 2019;
Revised February 1, 2019;
Accepted March 1, 2019}

\maketitle




\begin{abstract}
Predicting contact maps and tertiary structure of proteins continues
to be important as the progress of experimentally solved structures
is slow. 
Even though grouping by both sequence and structure homology can in many
cases give an idea of the structure of protein there are still
many groups of proteins that lack a representative structure.
To help in this, we here present PconsFam which is an intuative and
interactive webinterface for predicted contact maps and tertiary
structure models of the entire PFAM-database.
By modelling all families, both those with and those without a
representative structure, using the PconsFold2 pipeline, and running
quality assessment estimator on them we can give an estimation for how
confident the contact maps and structures are. 
PconsFam is planned to follow each PFAM release and present predicted
structures for families both with and without representative structure
and present them in an easily accessible format.

\end{abstract}

\section{Introduction}

In recent years it has been shown that by the use of evolutionary
information and direct coupling analysis~\cite{Weigt19116270} it is
possible to obtain sufficiently accurate contact prediction of
proteins from their sequence and multiple sequence alignment alone to
predict accurate structures of many protein
families~\cite{Sulkowska2012}. At first the DCA methods were limited
to very large protein families, but with the use of deep learning
methodologies to improve the contact predictions it is nowadays
possible to accurately predict the contacts for families with only a
few hundred members~\cite{Skwark25375897,Michel28535189,Wang28056090}

Using these predicted contacts it is then possible to model the
structure of a protein using a protein folding program. Here,
initially CNS was used ~\cite{Morcos22106262} but Rosetta has also
been used~\cite{Baker:1999}. Although it is possible that models
created by Rosetta are of slighlty higher quality than models by
CNS~\cite{Michel25161237} the advantagae of CNS is clear as it is much
faster. 

Recently we developed the PconsFold2 pipeline~\cite{Michel28881974}, which uses contact
predictions from PconsC3~\cite{Michel28535189} the CNS based CONFOLD folding
algorithm~\cite{Adhikari25974172} and most importantly multiple model quality estimations
\cite{Uziela28052925,Lundstrom:2001} to predict the structure of
proteins. Here we present the related web resource PconsFam
(https://pconsfam.bioinfo.se) a database with predicted structural
information for most Pfam families using the PconsFold2
pipeline.

The PconsFold2 pipeline can predict accurate models (TM-score $>0.5$
for 51\% of the large families ($>1000$ effective sequences). For
smaller families the fraction of correct models decreases, but they
still exist. Therefore, a major challenge for large scale predictions
is to distinguish between correct and incorrect models. Here, we have
applied a set of model quality estimation methods~\cite{Kryshtafovych28833563}.

\begin{table}[]
\centering
\caption{Number of Pfam families with unknown structure that can be modeled at
1\% and 10\% FPR.}
\label{tab:nopdb1}
    \begin{tabular}{lp{2cm}rp{2cm}rp{2cm}}
  \hline
 & 0.01 & 0.1 \\ 
  \hline
  ProQ3D & 36 & 225 \\ 
  PcombC & 42 & 179 \\ 
  Pcons & 18 & 218 \\ 
  CNS-contact & 62 & 232 \\  \hline 
  Union & 114 & 558 \\ 
  All & 6379 &  6379 \\ 
   \hline
\end{tabular}
\end{table}
When the PconsFold2 pipeline was applied to 6379 PFAM families of
unknown structure 558 models with a predicted specificity over 90\% was
created. Out of these, 415 had never been reported before.

{\bf With
PconsFam we extend this pipeline to the full PFAM database to predict
multiple contact maps and subsequently multiple structures of all
representative sequences for all Pfam families. }

For each family in
PFAM, multiple contact maps are generated and from these a set of
models are predicted and ranked with quality assessment
estimators. The model quality estimation gives an indication on the
reliability of the model. 
\newpage
The top ranked models for each predicted
family can be visualised and are available for download. The full set
of contact predictions for is available for visualisation together
with the predicted model in an intuitive and powerful user-interface
that allows interaction between the contact maps and the predicted
structure. 

\section{Material and methods}
\subsection{PconsFold2}
PconsFold2 works in three separate steps. Firstly, multiple alignments
are generated using HHblits and Jackhmmer ~\cite{eddy22039361} at different 
E-value cutoffs.
Secondly, PConsC3 is used for contact predictions. All the alignments are used to 
create one contact map for each alignment.
Thirdly, these contact maps, together with predicted secondary structure, is used
as input to CONFOLD to generate 50 models for each contact map, resulting in a total
of 200 models.

\subsection{Model Quality assessment}
The default ranking of models generated by CONFOLD is by the CNS contact energy (NOE) 
which is the sum of all violations of all contact restraints used in the input.
To make the score comparable between models it is normalized by protein length.
To easily rank the top model, the three measures Pcons, ProQ3D and PPV was 
combined to create the PcombC score as follows.

$$
S_{PcombC} = \frac{0.3}{1.9} \cdot S_{Pcons} + \frac{0.6}{1.9} \cdot S_{ProQ3D} + \frac{1.0}{1.9} \cdot PPV
$$

This was used on all families with a known structure to rank the best model.

For families without a known structure the union of all quality assesment methods were used.
A score cutoff at FPR 0.01 and 0.1 was used to estimate how many unknown structures
could be predicted accurately (TM-score $\ge 0.5$). The result can be seen in table~\ref{tab:ss}.
\subsection{Updates}

With our pipeline the website will be updated with every PFAM release
and the currently running update on PFAM 31.0 will introduce
additional quality estimators such as PconsC4 and ProQ4
scores. 

\subsection{Topology}
The knotted topology was established using an implementation of Alexander polynomial described in the KnotProt database \cite{jamroz2014knotprot}. One hundred random closures are chosen in a way that the endpoints are connected to two randomly 
chosen points on a sphere encompassing the whole protein. The two new endpoints are 
connected on the surface of the sphere. The closed backbone is then reduced using a
KMT algorithm and the Alexander polynomial is computed. The structure is called knotted if the same type of knot
appear more than 40\% of cases. 

\section{Results}


\subsection{Overview}

PconsFam contains predictions for 13617 Pfam families, out of these
6477 have a member of known structure and  7140 not.  The median size
of the famil

\begin{table}
\begin{tabular}{lcccccc}
Dataset & Meff & PPV & TM & FDR & Pcons & ProQ3\\   
All  &  200 & - & - & 0.40 & 0.19 & 0.35\\
Structure &  486 &  0.46 & 0.41 & 0.28 & 0.25 & 0.45\\ \\
NoStructure  111 & - & - & 0.45 & 0.16 & 0.27 \\
\end{tabular}
\caption{Median data for PconsFam}
\label{tab:summary}
\end{table}

\iffalse

> summary(data)
          ID            pcons            proq3              M
 PF00001.18:    1   Min.   :0.0180   Min.   :0.0000   Min.   :     3
 PF00002.21:    1   1st Qu.:0.1250   1st Qu.:0.2072   1st Qu.:  1099
 PF00003.19:    1   Median :0.1940   Median :0.3471   Median :  4754
 PF00004.26:    1   Mean   :0.2217   Mean   :0.3552   Mean   : 21818
 PF00005.24:    1   3rd Qu.:0.2860   3rd Qu.:0.4981   3rd Qu.: 19908
 PF00006.22:    1   Max.   :0.8130   Max.   :0.8285   Max.   :706707
 (Other)   :13611                                     NA's   :7125
       N             Meff                ppv             TPR
 Min.   :  50   Min.   :     1.00   Min.   :0.131   Min.   :0.131
 1st Qu.:  90   1st Qu.:    67.18   1st Qu.:0.378   1st Qu.:0.378
 Median : 137   Median :   200.37   Median :0.457   Median :0.457
 Mean   : 174   Mean   :  2286.23   Mean   :0.452   Mean   :0.452
 3rd Qu.: 220   3rd Qu.:   918.42   3rd Qu.:0.528   3rd Qu.:0.528
 Max.   :1104   Max.   :151761.72   Max.   :0.724   Max.   :0.724
                                    NA's   :7125    NA's   :7125
      FPR              tm             fdr
 Min.   :0.276   Min.   :0.006   Min.   :0.0000
 1st Qu.:0.472   1st Qu.:0.272   1st Qu.:0.2346
 Median :0.543   Median :0.410   Median :0.4047
 Mean   :0.548   Mean   :0.424   Mean   :0.3749
 3rd Qu.:0.622   3rd Qu.:0.566   3rd Qu.:0.5248
 Max.   :0.869   Max.   :0.846   Max.   :0.6378
 NA's   :7125    NA's   :7136    NA's   :5
>
> summary(structure)
          ID           pcons            proq3              M
 PF00001.18:   1   Min.   :0.0320   Min.   :0.0000   Min.   :     3
 PF00002.21:   1   1st Qu.:0.1690   1st Qu.:0.2792   1st Qu.:  1098
 PF00003.19:   1   Median :0.2500   Median :0.4482   Median :  4742
 PF00004.26:   1   Mean   :0.2782   Mean   :0.4198   Mean   : 21770
 PF00005.24:   1   3rd Qu.:0.3620   3rd Qu.:0.5647   3rd Qu.: 19850
 PF00006.22:   1   Max.   :0.8130   Max.   :0.8159   Max.   :706707
 (Other)   :6471
       N              Meff               ppv              TPR
 Min.   : 50.0   Min.   :     1.0   Min.   :0.1312   Min.   :0.1312
 1st Qu.: 85.0   1st Qu.:   144.1   1st Qu.:0.3785   1st Qu.:0.3785
 Median :125.0   Median :   486.5   Median :0.4564   Median :0.4564
 Mean   :156.3   Mean   :  2231.6   Mean   :0.4524   Mean   :0.4524
 3rd Qu.:195.0   3rd Qu.:  1418.3   3rd Qu.:0.5284   3rd Qu.:0.5284
 Max.   :718.0   Max.   :151761.7   Max.   :0.7239   Max.   :0.7239

      FPR               tm              fdr
 Min.   :0.2761   Min.   :0.0061   Min.   :0.0000
 1st Qu.:0.4716   1st Qu.:0.2720   1st Qu.:0.1335
 Median :0.5436   Median :0.4094   Median :0.2768
 Mean   :0.5476   Mean   :0.4236   Mean   :0.2887
 3rd Qu.:0.6215   3rd Qu.:0.5660   3rd Qu.:0.4323
 Max.   :0.8688   Max.   :0.8458   Max.   :0.6377

> summary(nostruct)
          ID           pcons            proq3              M
 PF00024.23:   1   Min.   :0.0180   Min.   :0.0000   Min.   :   692
 PF00038.18:   1   1st Qu.:0.1000   1st Qu.:0.1781   1st Qu.:  3420
 PF00050.18:   1   Median :0.1570   Median :0.26 0.2781   Median :  9138
 PF00053.21:   1   Mean   :0.1705   Mean   :0.2966   Mean   : 42680
 PF00084.17:   1   3rd Qu.:0.2240   3rd Qu.:0.4085   3rd Qu.: 75510
 PF00094.22:   1   Max.   :0.8030   Max.   :0.8285   Max.   :171263
 (Other)   :7134                                     NA's   :7125
       N             Meff                ppv             TPR
 Min.   :  50   Min.   :     1.00   Min.   :0.263   Min.   :0.263
 1st Qu.:  94   1st Qu.:    42.43   1st Qu.:0.396   1st Qu.:0.396
 Median : 149   Median :   111.21   Median :0.524   Median :0.524
 Mean   : 190   Mean   :  2335.80   Mean   :0.489   Mean   :0.489
 3rd Qu.: 243   3rd Qu.:   330.98   3rd Qu.:0.554   3rd Qu.:0.554
 Max.   :1104   Max.   :118875.61   Max.   :0.704   Max.   :0.704
                                    NA's   :7125    NA's   :7125
      FPR              tm             fdr
 Min.   :0.296   Min.   :0.653   Min.   :0.0000
 1st Qu.:0.446   1st Qu.:0.662   1st Qu.:0.3635
 Median :0.476   Median :0.694   Median :0.4815
 Mean   :0.511   Mean   :0.702   Mean   :0.4531
 3rd Qu.:0.604   3rd Qu.:0.734   3rd Qu.:0.5639
 Max.   :0.737   Max.   :0.768   Max.   :0.6378
 NA's   :7125    NA's   :7136    NA's   :5
\fi

\subsection{Comparison with other resources}

A similar resource is Baker Lab’s GREMLIN database~\cite{Kamisetty2013} which builds contact prediction based on
PFAM 27.0~\cite{Sonnhammer:1997} . However, it has not been updated since
2013. In contrast we plan to update PconsFam within a few month after
each Pfam release. This is possible as the pipeline uses a much less
computationally costly methodology and is highly modular. Each of the three steps
(generate alignments, generate contact maps and generate models) can be changed
independently with faster/more accurate tools. PconsC4, which is currently
being implemented, is at least one order of
magnitude faster than comparative methods and by using CONFOLD the
folding is much faster than Rosetta.


GREMLIN shows predicted contact maps with an option to overlay with
the pdb structure if one exists. We extend on this by using a tool
that can visualize the predicted contacts on the models. In our
database, both contact maps and predicted structure can be
investigated in detail and downloaded.  We have also used a deep
learning methodology for contact predictions. In general this provide
the better coverage of small protein families.


Topology plays an ever-increasing role in modern life sciences since
the discovery and artificial creation of knots in proteins and DNA.
Nowadays, at least 7\% of proteins are known to be knotted, linked or
to contain lassos, even though for a long time it was believed that
proteins should not be entangled \cite{sulkowska2018entangled}. Knotted proteins appear in all
kingdoms of life, and tend to be preserved throughout evolution \cite{sulkowska2012conservation}. 
Knots are believed to be functionally advantageous and to provide extra
stability to protein chains \cite{christian2016methyl}.
Thus the PconsFam reports also the information about the topology of
modeled structures. This information should be used as an additional
descriptor to validate structures \cite{khatib2006rapid}. The figure shows a
predicted structure from PF01018 family with the so-called Gordian
knot. It was shown that even though members of this family have very
low sequence similarity (below 20\%), the topology of all known
structures is the same \cite{sulkowska2012conservation}.



\begin{figure}[t]
\begin{center}
\end{center}
\caption{PconsC3/4 vs DCA
ProQ evaluations 
The PconsFold pipeline.}
    \includegraphics[width=0.5\textwidth]{figures/flowchart.eps}
\label{fig:Pipeline}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{Comparison of contact prediction methods and available resources
Comparison of databases of structure predictions
Gremlin
EV-fold ?
Zhang ?.}
    \includegraphics[width=0.5\textwidth]{figures/fig1_PNAS.eps}
\label{fig:comparison}

\end{figure}
\begin{figure}[t]
\begin{center}
\end{center}
\caption{Comparison of contact prediction methods and available resources
Comparison of databases of structure predictions
Gremlin
EV-fold ?
Zhang ?.}
    \includegraphics[width=0.5\textwidth]{figures/fig4_PNAS.eps}
\label{fig:comparison}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{Overview of number of structures at different qualities - from PconsFold
verview of the database.}
    \includegraphics[width=0.5\textwidth]{figures/fig_pfam_ppv_native_vs_model.eps}
\label{fig:overview}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{Links Knots - topology.}
\label{fig:Interface}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{.}
\label{fig:exampel PF0009.24}
\end{figure}


\begin{table}[t!]
\centering
\caption{Average PPV of top $N/2$ predicted contacts on the benchmark dataset for different secondary structural classes. \label{tab:ss}}
%{\begin{tabular}{lp{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}}\toprule
{\begin{tabular}{lcccc}
  \hline
 & all & mainly-$\alpha$ & mainly-$\beta$ & $\alpha-\beta$ \\ 
  \hline
  PconsC3 & 0.57 & 0.49 & 0.59 & 0.62 \\ 
    MetaPSICOV & 0.59 & 0.54 & 0.58 & 0.62 \\ 
    PconsC2 & 0.48 & 0.44 & 0.45 & 0.51 \\ 
    PlmDCA & 0.36 & 0.34 & 0.32 & 0.38 \\ 
    GaussDCA & 0.34 & 0.33 & 0.31 & 0.36 \\ 
    PSICOV & 0.34 & 0.30 & 0.33 & 0.35 \\ 
    PhyCMAP & 0.32 & 0.23 & 0.34 & 0.36 \\ 
   \hline
  counts & 210 & 55 & 35 & 110 \\
   \hline
\end{tabular}}{}
\end{table}


\begin{table*}[tb!]
\centering
\caption{Properties of Pfam families that can be modeled accurately at FPR
0.1. Statistical significant differences
from a students t-test at P-values 0.01 and $10^{-5}$ are marked with $^*$ and
$^{**}$ respectively for all columns except the last.}

\label{tab:nopdb2}
\begin{tabular}{lllllllll}
  \hline
  & PconsC3 score & Helix & Sheet & Coil & Meff & Length & Transmembrane & TM-score\\ 
  \hline
  %ProQ3D & 0.64 & 0.5$^{**}$ & 0.47$^{**}$ & 0.1$^{**}$ & 0.42$^{**}$ & 375.72$^{**}$ & 102.6$^{**}$ & 0.07$^{**}$ \\ 
  %PcombC & 0.55 & 0.62$^{**}$ & 0.35 & 0.2 & 0.46 & 2218.11 & 99.27$^{**}$ & 0.09* \\ 
  %Pcons & 0.55 & 0.55$^{**}$ & 0.51$^{**}$ & 0.11 & 0.38$^{**}$ & 877.15 & 107.55$^{**}$ & 0.18 \\ 
  %CNS-contact & 10.47 & 0.59$^{**}$ & 0.08$^{**}$ & 0.27$^{**}$ & 0.65$^{**}$ & 3960.06$^{*}$ & 101.29$^{**}$ & 0.01$^{**}$ \\  \hline 
  Union & 0.41$^{**}$ & 0.33$^{*}$ & 0.18$^{*}$ & 0.5 & 427$^*$ & 104$^{**}$ & 0.11$^{**}$ & 0.56\\ 
  PfamPDB & 0.45$^{**}$ & 0.34 & 0.21$^{**}$ & 0.46$^{**}$ & 1075$^{**}$ & 126$^{**}$ & 0.04$^{**}$ & 0.53 \\ \hline
  NoPDB & 0.32 & 0.36 & 0.15 & 0.50 & 300 & 187 & 0.25 & \\
   \hline
\end{tabular}

\end{table*}



\section{Discussion}
                
In summary the novelties of PconsFam are:
An informative user interface that enables examination of multiple models and contact maps.
Novel tool to help investigate and interpret contact maps.
Using the same pipeline for families with and without known structures.
We use model quality estimation methods (ProQ and Pcons) to evaluate FDR 
PconsFam is complementary to existing resources, i.e.\ high quality models exist for other families than in Gremlin.
PconsFam will be updated at regular times to follow PFAM releases.

Modularity of pipeline
As PconsFold2 is highly modular, each of the three steps in the pipeline
can be changed independently. Any alignment tool can be used to generate the 
alignments and any contact prediction tool can be used. This opens up
the possibility to run different tools for different dataset where
there are known tools that works better for specific data.

Future directions
Currently the input to CONFOLD is both predicted contact maps from PConsC3 and
predicted secondary structure from PSIPRED. Both of these are predicted in PConsC4
so a change to PConsC4 will streamline the process even further. PConsC4 is also
much faster than the currently implemented PConsC3 and will therefore enable
both more frequent updates but also higher quality contact maps.

An improved model quality estimator in ProQ4 is also being worked on to increase
or quality assessment methods.

\section{Conclusions}
Here we present an intuative and interactive webinterface for contact maps and 
models for PFAM-families. We have used the modula PconsFold2 pipeline to predicted
both multiple contact maps and multiple models for all legible families and presents
both of these both visually with interactive possibilities together with quality 
assessment scores to highlight the confidence in both contact maps and models.
The underlying pipeline is planned to follow each PFAM release and therefore
show updated and relevant data.

\section{Acknowledgements}

This work was supported by National Science Centre #2012/07/E/NZ1/01900 (to JIS).


\subsubsection{Conflict of interest statement.} None declared.

\bibliographystyle{science}
\bibliography{refs}


\end{document}


@article{jamroz2014knotprot,
  title={KnotProt: a database of proteins with knots and slipknots},
  author={Jamroz, Michal and Niemyska, Wanda and Rawdon, Eric J and Stasiak, Andrzej and Millett, Kenneth C and Su{\l}kowski, Piotr and Sulkowska, Joanna I},
  journal={Nucleic acids research},
  volume={43},
  number={D1},
  pages={D306--D314},
  year={2014},
  publisher={Oxford University Press},
  note={10.1093/nar/gku1059}
}
@article{sulkowska2012conservation,
  title={Conservation of complex knotting and slipknotting patterns in proteins},
  author={Su{\l}kowska, Joanna I and Rawdon, Eric J and Millett, Kenneth C and Onuchic, Jose N and Stasiak, Andrzej},
  journal={Proceedings of the National Academy of Sciences},
  volume={109},
  number={26},
  pages={E1715--E1723},
  year={2012},
  publisher={National Acad Sciences},
  note={10.1073/pnas.1205918109}
}
@incollection{sulkowska2018entangled,
  title={Entangled Proteins: Knots, Slipknots, Links, and Lassos},
  author={Sulkowska, Joanna I and Su{\l}kowski, Piotr},
  booktitle={The Role of Topology in Materials},
  pages={201--226},
  year={2018},
  publisher={Springer}
}
@article{christian2016methyl,
  title={Methyl transfer by substrate signaling from a knotted protein fold},
  author={Christian, Thomas and Sakaguchi, Reiko and Perlinska, Agata P and Lahoud, Georges and Ito, Takuhiro and Taylor, Erika A and Yokoyama, Shigeyuki and Sulkowska, Joanna I and Hou, Ya-Ming},
  journal={Nature structural \& molecular biology},
  volume={23},
  number={10},
  pages={941},
  year={2016},
  publisher={Nature Publishing Group}
}
@article{khatib2006rapid,
  title={Rapid knot detection and application to protein structure prediction},
  author={Khatib, Firas and Weirauch, Matthew T and Rohl, Carol A},
  journal={Bioinformatics},
  volume={22},
  number={14},
  pages={e252--e259},
  year={2006},
  publisher={Oxford University Press}
}

