\documentclass[a4,center,fleqn]{NAR}

% Enter dates of publication
\copyrightyear{2018}
\pubdate{31 July 2019}
\pubyear{2019}
\jvolume{00}
\jissue{00}

%\articlesubtype{This is the article type (optional)}

\begin{document}

\title{PconsFam: A regularly updated database of structure predictions of all Pfam families available at http://pconsfold.bioinfo.se/}

\author{%
John Lamb\,$^{1,*}$,
Aleksandra Jarmolińska\,$^{2,*}$
Mirco Michel\,$^{1,*}$,
David Menéndez-Hurtado\,$^{1,*}$,
Joanna Sułkowska,$^{2,\dagger}$
Arne Elofsson\,$^{1,\dagger}$%
\footnote{To whom correspondence should be addressed.
Tel: +46 706951045; Email: arne@bioinfo.se}}

\address{%
$^{1}$Science for Life Laboratory and Department of Biochemistry and
biophysics, Stockholm Unviersity, Tomtebodav 23, 171 21 Solna, Sweden
and
$^{2}$ Interdisciplinary Laboratory of Biological Systems Modelling
ul. S. Banacha 2c, 02-097 Warsaw, Poland 
$^{*}$ contributed equally
$^{\dagger}$=contributing authors
% Affiliation must include:
% Department name, institution name, full road and district address,
% state, Zip or postal code, country
}

\history{%
Received January 1, 2019;
Revised February 1, 2019;
Accepted March 1, 2019}

\maketitle





\begin{abstract}


\end{abstract}

\section{Introduction}

In recent years it has been shown that by the use of evolutionary
information and direct coupling analysis~\cite{Weigt19116270} it is
possible to obtain sufficiently accurate contact prediction of
proteins from their sequence and multiple sequence alignment alone to
predict accurate structures of many protein
families~\cite{Sulkowska2012}. At first the DCA methods were limited
to very large protein families, but with the use of deep learning
methodologies to improve the contact predictions it is nowadays
possible to accurately predict the contacts for families with only a
few hundred members~\cite{Skwark25375897,Michel28535189,Wang28056090}

Using these predicted contacts it is then possible to model the
structure of a protein using a protein folding program. Here,
initially CNS was used ~\cite{Morcos22106262} but Rosetta has also
been used~\cite{Baker:1999}. Although it is possible that models
created by Rosetta are of slighlty higher quality than models by
CNS~\cite{Michel25161237} the advantagae of CNS is clear as it is much
faster. 


Recently we developed the PconsFold2 pipeline~\cite{Michel28881974}, which uses contact
predictions from PconsC3~\cite{Michel28535189} the CNS based CONFOLD folding
algorithm~\cite{Adhikari25974172} and most importantly multiple model quality estimations
\cite{Uziela28052925,Lundstrom:2001} to predict the structure of
proteins. Here we present the related web resource PconsFam
(https://pconsfam.bioinfo.se) a database with predicted structural
information for most Pfam families using the PconsFold2
pipeline.


The PconsFold2 pipeline can predict accurate models (TM-score $>0.5$
for 51\% of the large families ($>1000$ effective sequences). For
smaller families the fraction of correct models decreases, bu they
still exist. Therefore, a major challenge for large scale predictions
is to distinguish between correct and incorrect models. Here, we have
applied a set of model quality estimation methods~\cite{Kryshtafovych28833563}.


\bf{(ADD MORE NUMBERS)}


When the PconsFold2 pipeline was applied to 6379 PFAM families of
unknown structure 558 modes with a predicted specificity over 90\% was
created. Out of these, 415 had never been reported before.

{\bf With
PconsFam we extend this pipeline to the full PFAM database to predict
multiple contact maps and subsequently multiple structures of all
representative sequences for all Pfam families. }

For each family in
PFAM, multiple contact maps are generated and from these a set of
models are predicted and ranked with quality assessment
estimators. The model quality estimation gives an indication on the
reliability of the model. The top ranked models for each predicted
family can be visualised and are available for download. The full set
of contact predictions for is available for visualisation together
with the predicted model in an intuitive and powerful user-interface
that allows interaction between the contact maps and the predicted
structure. 

\section{Material and methods}
\subsection{PconsFold2}
We have used 

PconsC4
CONFOLD

\subsection{Model Quality assessment}
Pcons
ProQ4
PPV
Known PDB structures

\subsection{Updates}

With our pipeline the website will be updated with every PFAM release
and the currently running update on PFAM 31.0 will introduce
additional quality estimators such as PPV, Pcons score and ProQ4
scores. 

\section{Results}


\subsection{Overview}

PconsFam contains predictions for 13617 Pfam families, out of these
6477 have a member of known structure and  7140 not.  The median size
of the famil

\begin{table}
\begin{tabular}{lcccccc}
Dataset & Meff & PPV & TM & FDR & Pcons & ProQ3\\   
All  &  200 & - & - & 0.40 & 0.19 & 0.35\\
Structure &  486 &  0.46 & 0.41 & 0.28 & 0.25 & 0.45\\ \\
NoStructure  111 & - & - & 0.45 & 0.16 & 0.27 \\
\end{tabular}
\caption{Median data for PconsFam}
\label{tab:summary}
\end{table}

\iffalse

> summary(data)
          ID            pcons            proq3              M
 PF00001.18:    1   Min.   :0.0180   Min.   :0.0000   Min.   :     3
 PF00002.21:    1   1st Qu.:0.1250   1st Qu.:0.2072   1st Qu.:  1099
 PF00003.19:    1   Median :0.1940   Median :0.3471   Median :  4754
 PF00004.26:    1   Mean   :0.2217   Mean   :0.3552   Mean   : 21818
 PF00005.24:    1   3rd Qu.:0.2860   3rd Qu.:0.4981   3rd Qu.: 19908
 PF00006.22:    1   Max.   :0.8130   Max.   :0.8285   Max.   :706707
 (Other)   :13611                                     NA's   :7125
       N             Meff                ppv             TPR
 Min.   :  50   Min.   :     1.00   Min.   :0.131   Min.   :0.131
 1st Qu.:  90   1st Qu.:    67.18   1st Qu.:0.378   1st Qu.:0.378
 Median : 137   Median :   200.37   Median :0.457   Median :0.457
 Mean   : 174   Mean   :  2286.23   Mean   :0.452   Mean   :0.452
 3rd Qu.: 220   3rd Qu.:   918.42   3rd Qu.:0.528   3rd Qu.:0.528
 Max.   :1104   Max.   :151761.72   Max.   :0.724   Max.   :0.724
                                    NA's   :7125    NA's   :7125
      FPR              tm             fdr
 Min.   :0.276   Min.   :0.006   Min.   :0.0000
 1st Qu.:0.472   1st Qu.:0.272   1st Qu.:0.2346
 Median :0.543   Median :0.410   Median :0.4047
 Mean   :0.548   Mean   :0.424   Mean   :0.3749
 3rd Qu.:0.622   3rd Qu.:0.566   3rd Qu.:0.5248
 Max.   :0.869   Max.   :0.846   Max.   :0.6378
 NA's   :7125    NA's   :7136    NA's   :5
>
> summary(structure)
          ID           pcons            proq3              M
 PF00001.18:   1   Min.   :0.0320   Min.   :0.0000   Min.   :     3
 PF00002.21:   1   1st Qu.:0.1690   1st Qu.:0.2792   1st Qu.:  1098
 PF00003.19:   1   Median :0.2500   Median :0.4482   Median :  4742
 PF00004.26:   1   Mean   :0.2782   Mean   :0.4198   Mean   : 21770
 PF00005.24:   1   3rd Qu.:0.3620   3rd Qu.:0.5647   3rd Qu.: 19850
 PF00006.22:   1   Max.   :0.8130   Max.   :0.8159   Max.   :706707
 (Other)   :6471
       N              Meff               ppv              TPR
 Min.   : 50.0   Min.   :     1.0   Min.   :0.1312   Min.   :0.1312
 1st Qu.: 85.0   1st Qu.:   144.1   1st Qu.:0.3785   1st Qu.:0.3785
 Median :125.0   Median :   486.5   Median :0.4564   Median :0.4564
 Mean   :156.3   Mean   :  2231.6   Mean   :0.4524   Mean   :0.4524
 3rd Qu.:195.0   3rd Qu.:  1418.3   3rd Qu.:0.5284   3rd Qu.:0.5284
 Max.   :718.0   Max.   :151761.7   Max.   :0.7239   Max.   :0.7239

      FPR               tm              fdr
 Min.   :0.2761   Min.   :0.0061   Min.   :0.0000
 1st Qu.:0.4716   1st Qu.:0.2720   1st Qu.:0.1335
 Median :0.5436   Median :0.4094   Median :0.2768
 Mean   :0.5476   Mean   :0.4236   Mean   :0.2887
 3rd Qu.:0.6215   3rd Qu.:0.5660   3rd Qu.:0.4323
 Max.   :0.8688   Max.   :0.8458   Max.   :0.6377

> summary(nostruct)
          ID           pcons            proq3              M
 PF00024.23:   1   Min.   :0.0180   Min.   :0.0000   Min.   :   692
 PF00038.18:   1   1st Qu.:0.1000   1st Qu.:0.1781   1st Qu.:  3420
 PF00050.18:   1   Median :0.1570   Median :0.26 0.2781   Median :  9138
 PF00053.21:   1   Mean   :0.1705   Mean   :0.2966   Mean   : 42680
 PF00084.17:   1   3rd Qu.:0.2240   3rd Qu.:0.4085   3rd Qu.: 75510
 PF00094.22:   1   Max.   :0.8030   Max.   :0.8285   Max.   :171263
 (Other)   :7134                                     NA's   :7125
       N             Meff                ppv             TPR
 Min.   :  50   Min.   :     1.00   Min.   :0.263   Min.   :0.263
 1st Qu.:  94   1st Qu.:    42.43   1st Qu.:0.396   1st Qu.:0.396
 Median : 149   Median :   111.21   Median :0.524   Median :0.524
 Mean   : 190   Mean   :  2335.80   Mean   :0.489   Mean   :0.489
 3rd Qu.: 243   3rd Qu.:   330.98   3rd Qu.:0.554   3rd Qu.:0.554
 Max.   :1104   Max.   :118875.61   Max.   :0.704   Max.   :0.704
                                    NA's   :7125    NA's   :7125
      FPR              tm             fdr
 Min.   :0.296   Min.   :0.653   Min.   :0.0000
 1st Qu.:0.446   1st Qu.:0.662   1st Qu.:0.3635
 Median :0.476   Median :0.694   Median :0.4815
 Mean   :0.511   Mean   :0.702   Mean   :0.4531
 3rd Qu.:0.604   3rd Qu.:0.734   3rd Qu.:0.5639
 Max.   :0.737   Max.   :0.768   Max.   :0.6378
 NA's   :7125    NA's   :7136    NA's   :5
\fi

\subsection{Comparison with other resources}

A similar resource is Baker Lab’s GREMLIN database~\cite{Kamisetty2013} which builds contact prediction based on
PFAM 27.0~\cite{Sonnhammer:1997} . However, it has not been updated since
2013. In contrast we plan to update PconsFam within a few month after
each Pfam release. This is possible as the pipeline uses a much less
computationally costly methodology. PconsC4 is at least one order of
magnitude faster than comparative methods and by using CONFOLD the
folding is much faster than Rosetta.


GREMLIN shows predicted contact maps with an option to overlay with
the pdb structure if one exists. We extend on this by using a tool
that can visualize the predicted contacts on the models. In our
database, both contact maps and predicted structure can be
investigated in detail and downloaded.  We have also used a deep
learning methodology (currently PconsC3 but will be updated to PconsC4
before publication) for contact predictions. In general this provide
the better coverage of small protein families.





\begin{figure}[t]
\begin{center}
\end{center}
\caption{PconsC3/4 vs DCA
ProQ evaluations 
The PconsFold pipeline.}
    \includegraphics[width=0.5\textwidth]{figures/flowchart.eps}
\label{fig:Pipeline}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{Comparison of contact prediction methods and available resources
Comparison of databases of structure predictions
Gremlin
EV-fold ?
Zhang ?.}
    \includegraphics[width=0.5\textwidth]{figures/fig1_PNAS.eps}
\label{fig:comparison}

\end{figure}
\begin{figure}[t]
\begin{center}
\end{center}
\caption{Comparison of contact prediction methods and available resources
Comparison of databases of structure predictions
Gremlin
EV-fold ?
Zhang ?.}
    \includegraphics[width=0.5\textwidth]{figures/fig4_PNAS.eps}
\label{fig:comparison}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{Overview of number of structures at different qualities - from PconsFold
verview of the database.}
    \includegraphics[width=0.5\textwidth]{figures/fig_pfam_ppv_native_vs_model.eps}
\label{fig:overview}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{Links Knots - topology.}
\label{fig:Interface}
\end{figure}


\begin{figure}[t]
\begin{center}
\end{center}
\caption{.}
\label{fig:exampel PF0009.24}
\end{figure}


\begin{table}[t!]
\centering
\caption{Average PPV of top $N/2$ predicted contacts on the benchmark dataset for different secondary structural classes. \label{tab:ss}}
%{\begin{tabular}{lp{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}}\toprule
{\begin{tabular}{lcccc}
  \hline
 & all & mainly-$\alpha$ & mainly-$\beta$ & $\alpha-\beta$ \\ 
  \hline
  PconsC3 & 0.57 & 0.49 & 0.59 & 0.62 \\ 
    MetaPSICOV & 0.59 & 0.54 & 0.58 & 0.62 \\ 
    PconsC2 & 0.48 & 0.44 & 0.45 & 0.51 \\ 
    PlmDCA & 0.36 & 0.34 & 0.32 & 0.38 \\ 
    GaussDCA & 0.34 & 0.33 & 0.31 & 0.36 \\ 
    PSICOV & 0.34 & 0.30 & 0.33 & 0.35 \\ 
    PhyCMAP & 0.32 & 0.23 & 0.34 & 0.36 \\ 
   \hline
  counts & 210 & 55 & 35 & 110 \\
   \hline
\end{tabular}}{}
\end{table}


\begin{table*}[tb!]
\centering
\caption{Properties of Pfam families that can be modeled accurately at FPR
0.1. Statistical significant differences
from a students t-test at P-values 0.01 and $10^{-5}$ are marked with $^*$ and
$^{**}$ respectively for all columns except the last.}

\label{tab:nopdb2}
\begin{tabular}{lllllllll}
  \hline
  & PconsC3 score & Helix & Sheet & Coil & Meff & Length & Transmembrane & TM-score\\ 
  \hline
  %ProQ3D & 0.64 & 0.5$^{**}$ & 0.47$^{**}$ & 0.1$^{**}$ & 0.42$^{**}$ & 375.72$^{**}$ & 102.6$^{**}$ & 0.07$^{**}$ \\ 
  %PcombC & 0.55 & 0.62$^{**}$ & 0.35 & 0.2 & 0.46 & 2218.11 & 99.27$^{**}$ & 0.09* \\ 
  %Pcons & 0.55 & 0.55$^{**}$ & 0.51$^{**}$ & 0.11 & 0.38$^{**}$ & 877.15 & 107.55$^{**}$ & 0.18 \\ 
  %CNS-contact & 10.47 & 0.59$^{**}$ & 0.08$^{**}$ & 0.27$^{**}$ & 0.65$^{**}$ & 3960.06$^{*}$ & 101.29$^{**}$ & 0.01$^{**}$ \\  \hline 
  Union & 0.41$^{**}$ & 0.33$^{*}$ & 0.18$^{*}$ & 0.5 & 427$^*$ & 104$^{**}$ & 0.11$^{**}$ & 0.56\\ 
  PfamPDB & 0.45$^{**}$ & 0.34 & 0.21$^{**}$ & 0.46$^{**}$ & 1075$^{**}$ & 126$^{**}$ & 0.04$^{**}$ & 0.53 \\ \hline
  NoPDB & 0.32 & 0.36 & 0.15 & 0.50 & 300 & 187 & 0.25 & \\
   \hline
\end{tabular}

\end{table*}



\section{Discussion}



                
In summary the novelties of PconsFam are:
An informative user interface that enables examination of multiple models and contact maps.
Novel tool to help investigate and interpret contact maps.
Using the same pipeline for families with and without known structures.
We use model quality estimation methods (ProQ and Pcons) to evaluate FDR 
PconsFam is complementary to existing resources, i.e. high quality models exist for other families than in Gremlin.
PconsFam will be updates at regular times to follow PFAM releases.
Future directions

Modularity of pipeline


Conctacts

SS prediciton

Newer PFAM


We are working un an  update of the 
database to use an update to the pipeline based of PconsC4, which is
much faster enabling frequent updates as well as an improved model
quality estimator, ProQ4.2

\section{Conclusions}





\section{ACKNOWLEDGEMENTS}

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text.


\subsubsection{Conflict of interest statement.} None declared.

\bibliographystyle{science}
\bibliography{refs}


\end{document}
